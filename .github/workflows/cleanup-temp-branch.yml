name: Cleanup Temp Branches

on:
  push:
    branches:
      - chore/day1-boot
  workflow_dispatch:

jobs:
  delete-main-protect:
    name: Delete main-protect branch
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Remove temporary branch
        uses: actions/github-script@v7
        with:
          script: |
            const branch = 'heads/main-protect';

            try {
              await github.rest.git.deleteRef({
                owner: context.repo.owner,
                repo: context.repo.repo,
                ref: branch
              });
              core.info(`Deleted ref ${branch}`);
            } catch (error) {
              if (error.status === 404) {
                core.info(`Branch ${branch} already removed.`);
              } else {
                throw error;
              }
            }
